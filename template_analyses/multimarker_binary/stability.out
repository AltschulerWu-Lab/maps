/awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
Preprocessing training set...
Preprocessing test set...

=== Experiment 1/8===
Starting replicate analysis...
Running replicate 1/50
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7629, Active: 2/2
  FUS/EEA1 - Loss: 0.7486, Acc: 0.5300 
  HSP70/SOD1 - Loss: 0.7773, Acc: 0.4900 
Cell Epoch 2/50, Overall Loss: 0.7218, Active: 2/2
  FUS/EEA1 - Loss: 0.6773, Acc: 0.6300 
  HSP70/SOD1 - Loss: 0.7664, Acc: 0.5267 
Cell Epoch 3/50, Overall Loss: 0.6990, Active: 2/2
  FUS/EEA1 - Loss: 0.6483, Acc: 0.6417 
  HSP70/SOD1 - Loss: 0.7496, Acc: 0.5267 
Cell Epoch 4/50, Overall Loss: 0.7103, Active: 2/2
  FUS/EEA1 - Loss: 0.7001, Acc: 0.6133 
  HSP70/SOD1 - Loss: 0.7205, Acc: 0.5417 
Cell Epoch 5/50, Overall Loss: 0.7088, Active: 2/2
  FUS/EEA1 - Loss: 0.6441, Acc: 0.6300 
  HSP70/SOD1 - Loss: 0.7735, Acc: 0.4783 
Cell Epoch 6/50, Overall Loss: 0.6964, Active: 2/2
  FUS/EEA1 - Loss: 0.6379, Acc: 0.6433 
  HSP70/SOD1 - Loss: 0.7549, Acc: 0.4933 
Cell Epoch 7/50, Overall Loss: 0.7036, Active: 2/2
  FUS/EEA1 - Loss: 0.6867, Acc: 0.6350 
  HSP70/SOD1 - Loss: 0.7206, Acc: 0.4983 
Cell Epoch 8/50, Overall Loss: 0.6451, Active: 2/2
  FUS/EEA1 - Loss: 0.5858, Acc: 0.7000 
  HSP70/SOD1 - Loss: 0.7043, Acc: 0.5283 
Cell Epoch 9/50, Overall Loss: 0.6517, Active: 2/2
  FUS/EEA1 - Loss: 0.5834, Acc: 0.7000 
  HSP70/SOD1 - Loss: 0.7200, Acc: 0.5183 
Cell Epoch 10/50, Overall Loss: 0.6420, Active: 2/2
  FUS/EEA1 - Loss: 0.5914, Acc: 0.6983 
  HSP70/SOD1 - Loss: 0.6926, Acc: 0.5533 
Cell Epoch 11/50, Overall Loss: 0.6360, Active: 2/2
  FUS/EEA1 - Loss: 0.5738, Acc: 0.7017 
  HSP70/SOD1 - Loss: 0.6982, Acc: 0.5617 
Cell Epoch 12/50, Overall Loss: 0.6109, Active: 2/2
  FUS/EEA1 - Loss: 0.5268, Acc: 0.7550 
  HSP70/SOD1 - Loss: 0.6950, Acc: 0.5233 
Cell Epoch 13/50, Overall Loss: 0.6171, Active: 2/2
  FUS/EEA1 - Loss: 0.5538, Acc: 0.7300 
  HSP70/SOD1 - Loss: 0.6803, Acc: 0.5717 
Cell Epoch 14/50, Overall Loss: 0.6352, Active: 2/2
  FUS/EEA1 - Loss: 0.5752, Acc: 0.6883 
  HSP70/SOD1 - Loss: 0.6952, Acc: 0.5317 
Cell Epoch 15/50, Overall Loss: 0.6638, Active: 2/2
  FUS/EEA1 - Loss: 0.6143, Acc: 0.6633 
  HSP70/SOD1 - Loss: 0.7133, Acc: 0.5550 
Cell Epoch 16/50, Overall Loss: 0.6575, Active: 2/2
  FUS/EEA1 - Loss: 0.6384, Acc: 0.6583 
  HSP70/SOD1 - Loss: 0.6767, Acc: 0.5617 
Cell Epoch 17/50, Overall Loss: 0.5844, Active: 2/2
  FUS/EEA1 - Loss: 0.5021, Acc: 0.7767 
  HSP70/SOD1 - Loss: 0.6667, Acc: 0.5817 
Cell Epoch 18/50, Overall Loss: 0.6346, Active: 2/2
  FUS/EEA1 - Loss: 0.6046, Acc: 0.6983 
  HSP70/SOD1 - Loss: 0.6646, Acc: 0.5883 
Cell Epoch 19/50, Overall Loss: 0.6347, Active: 2/2
  FUS/EEA1 - Loss: 0.5650, Acc: 0.6983 
  HSP70/SOD1 - Loss: 0.7045, Acc: 0.5117 
Cell Epoch 20/50, Overall Loss: 0.6248, Active: 2/2
  FUS/EEA1 - Loss: 0.5695, Acc: 0.7100 
  HSP70/SOD1 - Loss: 0.6801, Acc: 0.5667 
Cell Epoch 21/50, Overall Loss: 0.6459, Active: 2/2
  FUS/EEA1 - Loss: 0.6099, Acc: 0.6917 
  HSP70/SOD1 - Loss: 0.6820, Acc: 0.5733 
Cell Epoch 22/50, Overall Loss: 0.5917, Active: 2/2
  FUS/EEA1 - Loss: 0.5284, Acc: 0.7650 
  HSP70/SOD1 - Loss: 0.6549, Acc: 0.5967 
Cell Epoch 23/50, Overall Loss: 0.6005, Active: 2/2
  FUS/EEA1 - Loss: 0.5342, Acc: 0.7467 
  HSP70/SOD1 - Loss: 0.6667, Acc: 0.5833 
Cell Epoch 24/50, Overall Loss: 0.7174, Active: 2/2
  FUS/EEA1 - Loss: 0.7253, Acc: 0.6167 
  HSP70/SOD1 - Loss: 0.7095, Acc: 0.5150 
Cell Epoch 25/50, Overall Loss: 0.6591, Active: 2/2
  FUS/EEA1 - Loss: 0.6271, Acc: 0.6867 
  HSP70/SOD1 - Loss: 0.6911, Acc: 0.5467 
Cell Epoch 26/50, Overall Loss: 0.6242, Active: 2/2
  FUS/EEA1 - Loss: 0.5506, Acc: 0.7350 
  HSP70/SOD1 - Loss: 0.6978, Acc: 0.5317 
  Freezing FUS/EEA1 encoder at epoch 27
Cell Epoch 27/50, Overall Loss: 0.6127, Active: 1/2
  FUS/EEA1 - Loss: 0.5321, Acc: 0.7467 [FROZEN]
  HSP70/SOD1 - Loss: 0.6934, Acc: 0.5433 
Cell Epoch 28/50, Overall Loss: 0.7077, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7077, Acc: 0.5033 
Cell Epoch 29/50, Overall Loss: 0.7262, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7262, Acc: 0.5217 
Cell Epoch 30/50, Overall Loss: 0.6912, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6912, Acc: 0.5733 
Cell Epoch 31/50, Overall Loss: 0.6835, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6835, Acc: 0.5633 
  Freezing HSP70/SOD1 encoder at epoch 32
Cell Epoch 32/50, Overall Loss: 0.8237, Active: 0/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.8237, Acc: 0.4600 [FROZEN]
All antibodies frozen - stopping cell training at epoch 32
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.6823
Line Epoch 2/50, Loss: 0.5933
Line Epoch 3/50, Loss: 0.3893
Line Epoch 4/50, Loss: 0.2611
Line Epoch 5/50, Loss: 0.2263
Line Epoch 6/50, Loss: 0.8799
Line Epoch 7/50, Loss: 0.4953
Line Epoch 8/50, Loss: 0.3688
Line Epoch 9/50, Loss: 0.0866
Line Epoch 10/50, Loss: 0.1573
Line Epoch 11/50, Loss: 0.1353
Line Epoch 12/50, Loss: 0.2922
Line Epoch 13/50, Loss: 0.0883
Line Epoch 14/50, Loss: 0.2976
Line Epoch 15/50, Loss: 0.9876
Line Epoch 16/50, Loss: 0.3188
Line Epoch 17/50, Loss: 0.1129
Line Epoch 18/50, Loss: 0.1954
Line Epoch 19/50, Loss: 0.3939
Early stopping line training at epoch 19
Training completed!
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7884, Active: 2/2
  FUS/EEA1 - Loss: 0.8031, Acc: 0.4922 
  HSP70/SOD1 - Loss: 0.7736, Acc: 0.4756 
Cell Epoch 2/50, Overall Loss: 0.7174, Active: 2/2
  FUS/EEA1 - Loss: 0.6918, Acc: 0.5900 
  HSP70/SOD1 - Loss: 0.7431, Acc: 0.5422 
Cell Epoch 3/50, Overall Loss: 0.6573, Active: 2/2
  FUS/EEA1 - Loss: 0.6580, Acc: 0.6156 
  HSP70/SOD1 - Loss: 0.6567, Acc: 0.6144 
Cell Epoch 4/50, Overall Loss: 0.6623, Active: 2/2
  FUS/EEA1 - Loss: 0.6204, Acc: 0.6556 
  HSP70/SOD1 - Loss: 0.7041, Acc: 0.5833 
Cell Epoch 5/50, Overall Loss: 0.6171, Active: 2/2
  FUS/EEA1 - Loss: 0.5958, Acc: 0.6656 
  HSP70/SOD1 - Loss: 0.6384, Acc: 0.6189 
Cell Epoch 6/50, Overall Loss: 0.6523, Active: 2/2
  FUS/EEA1 - Loss: 0.6129, Acc: 0.6678 
  HSP70/SOD1 - Loss: 0.6917, Acc: 0.5722 
Cell Epoch 7/50, Overall Loss: 0.6323, Active: 2/2
  FUS/EEA1 - Loss: 0.6188, Acc: 0.6544 
  HSP70/SOD1 - Loss: 0.6457, Acc: 0.6100 
Cell Epoch 8/50, Overall Loss: 0.6053, Active: 2/2
  FUS/EEA1 - Loss: 0.5760, Acc: 0.7178 
  HSP70/SOD1 - Loss: 0.6345, Acc: 0.6367 
Cell Epoch 9/50, Overall Loss: 0.5917, Active: 2/2
  FUS/EEA1 - Loss: 0.5523, Acc: 0.7200 
  HSP70/SOD1 - Loss: 0.6311, Acc: 0.6256 
Cell Epoch 10/50, Overall Loss: 0.6568, Active: 2/2
  FUS/EEA1 - Loss: 0.6321, Acc: 0.6700 
  HSP70/SOD1 - Loss: 0.6816, Acc: 0.5867 
Cell Epoch 11/50, Overall Loss: 0.5958, Active: 2/2
  FUS/EEA1 - Loss: 0.5392, Acc: 0.7378 
  HSP70/SOD1 - Loss: 0.6524, Acc: 0.6267 
Cell Epoch 12/50, Overall Loss: 0.6092, Active: 2/2
  FUS/EEA1 - Loss: 0.5572, Acc: 0.7122 
  HSP70/SOD1 - Loss: 0.6612, Acc: 0.6100 
Cell Epoch 13/50, Overall Loss: 0.5742, Active: 2/2
  FUS/EEA1 - Loss: 0.5244, Acc: 0.7544 
  HSP70/SOD1 - Loss: 0.6239, Acc: 0.6422 
Cell Epoch 14/50, Overall Loss: 0.5862, Active: 2/2
  FUS/EEA1 - Loss: 0.5538, Acc: 0.7067 
  HSP70/SOD1 - Loss: 0.6186, Acc: 0.6533 
Cell Epoch 15/50, Overall Loss: 0.6556, Active: 2/2
  FUS/EEA1 - Loss: 0.6290, Acc: 0.6633 
  HSP70/SOD1 - Loss: 0.6822, Acc: 0.5756 
Cell Epoch 16/50, Overall Loss: 0.5704, Active: 2/2
  FUS/EEA1 - Loss: 0.5407, Acc: 0.7311 
  HSP70/SOD1 - Loss: 0.6001, Acc: 0.6678 
Cell Epoch 17/50, Overall Loss: 0.5767, Active: 2/2
  FUS/EEA1 - Loss: 0.5163, Acc: 0.7356 
  HSP70/SOD1 - Loss: 0.6371, Acc: 0.6456 
Cell Epoch 18/50, Overall Loss: 0.5772, Active: 2/2
  FUS/EEA1 - Loss: 0.5349, Acc: 0.7322 
  HSP70/SOD1 - Loss: 0.6194, Acc: 0.6444 
Cell Epoch 19/50, Overall Loss: 0.6092, Active: 2/2
  FUS/EEA1 - Loss: 0.5821, Acc: 0.7033 
  HSP70/SOD1 - Loss: 0.6362, Acc: 0.6256 
Cell Epoch 20/50, Overall Loss: 0.5548, Active: 2/2
  FUS/EEA1 - Loss: 0.5122, Acc: 0.7633 
  HSP70/SOD1 - Loss: 0.5974, Acc: 0.6600 
Cell Epoch 21/50, Overall Loss: 0.5994, Active: 2/2
  FUS/EEA1 - Loss: 0.5460, Acc: 0.7089 
  HSP70/SOD1 - Loss: 0.6527, Acc: 0.6111 /awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
/awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(

Cell Epoch 22/50, Overall Loss: 0.5875, Active: 2/2
  FUS/EEA1 - Loss: 0.5510, Acc: 0.7056 
  HSP70/SOD1 - Loss: 0.6239, Acc: 0.6411 
Cell Epoch 23/50, Overall Loss: 0.6065, Active: 2/2
  FUS/EEA1 - Loss: 0.5694, Acc: 0.6989 
  HSP70/SOD1 - Loss: 0.6436, Acc: 0.6189 
Cell Epoch 24/50, Overall Loss: 0.5888, Active: 2/2
  FUS/EEA1 - Loss: 0.5388, Acc: 0.7111 
  HSP70/SOD1 - Loss: 0.6387, Acc: 0.6144 
Cell Epoch 25/50, Overall Loss: 0.5778, Active: 2/2
  FUS/EEA1 - Loss: 0.5114, Acc: 0.7511 
  HSP70/SOD1 - Loss: 0.6443, Acc: 0.6211 
Cell Epoch 26/50, Overall Loss: 0.6478, Active: 2/2
  FUS/EEA1 - Loss: 0.6177, Acc: 0.6567 
  HSP70/SOD1 - Loss: 0.6779, Acc: 0.5767 
Cell Epoch 27/50, Overall Loss: 0.5595, Active: 2/2
  FUS/EEA1 - Loss: 0.5244, Acc: 0.7389 
  HSP70/SOD1 - Loss: 0.5947, Acc: 0.7000 
Cell Epoch 28/50, Overall Loss: 0.5755, Active: 2/2
  FUS/EEA1 - Loss: 0.5435, Acc: 0.7111 
  HSP70/SOD1 - Loss: 0.6075, Acc: 0.6778 
Cell Epoch 29/50, Overall Loss: 0.5935, Active: 2/2
  FUS/EEA1 - Loss: 0.5617, Acc: 0.7078 
  HSP70/SOD1 - Loss: 0.6253, Acc: 0.6589 
Cell Epoch 30/50, Overall Loss: 0.5801, Active: 2/2
  FUS/EEA1 - Loss: 0.5318, Acc: 0.7322 
  HSP70/SOD1 - Loss: 0.6283, Acc: 0.6367 
Cell Epoch 31/50, Overall Loss: 0.5709, Active: 2/2
  FUS/EEA1 - Loss: 0.5201, Acc: 0.7456 
  HSP70/SOD1 - Loss: 0.6216, Acc: 0.6589 
Cell Epoch 32/50, Overall Loss: 0.6057, Active: 2/2
  FUS/EEA1 - Loss: 0.5469, Acc: 0.7256 
  HSP70/SOD1 - Loss: 0.6645, Acc: 0.5978 
Cell Epoch 33/50, Overall Loss: 0.5763, Active: 2/2
  FUS/EEA1 - Loss: 0.5169, Acc: 0.7456 
  HSP70/SOD1 - Loss: 0.6356, Acc: 0.6333 
Cell Epoch 34/50, Overall Loss: 0.5877, Active: 2/2
  FUS/EEA1 - Loss: 0.5288, Acc: 0.7567 
  HSP70/SOD1 - Loss: 0.6467, Acc: 0.6311 
  Freezing FUS/EEA1 encoder at epoch 35
Cell Epoch 35/50, Overall Loss: 0.5955, Active: 1/2
  FUS/EEA1 - Loss: 0.5592, Acc: 0.7211 [FROZEN]
  HSP70/SOD1 - Loss: 0.6318, Acc: 0.6167 
Cell Epoch 36/50, Overall Loss: 0.7047, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7047, Acc: 0.5800 
  Freezing HSP70/SOD1 encoder at epoch 37
Cell Epoch 37/50, Overall Loss: 0.6589, Active: 0/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6589, Acc: 0.6056 [FROZEN]
All antibodies frozen - stopping cell training at epoch 37
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.6557
Line Epoch 2/50, Loss: 0.8641
Line Epoch 3/50, Loss: 0.6529
Line Epoch 4/50, Loss: 0.4091
Line Epoch 5/50, Loss: 0.6094
Line Epoch 6/50, Loss: 0.6798
Line Epoch 7/50, Loss: 0.2504
Line Epoch 8/50, Loss: 0.1112
Line Epoch 9/50, Loss: 0.3035
Line Epoch 10/50, Loss: 0.3380
Line Epoch 11/50, Loss: 0.1336
Line Epoch 12/50, Loss: 0.4265
Line Epoch 13/50, Loss: 0.3164
Line Epoch 14/50, Loss: 0.3378
Line Epoch 15/50, Loss: 0.1754
Line Epoch 16/50, Loss: 0.3209
Line Epoch 17/50, Loss: 0.3346
Line Epoch 18/50, Loss: 0.5848
Early stopping line training at epoch 18
Training completed!
Running replicate 2/50
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7689, Active: 2/2
  FUS/EEA1 - Loss: 0.7925, Acc: 0.4817 
  HSP70/SOD1 - Loss: 0.7453, Acc: 0.5317 
Cell Epoch 2/50, Overall Loss: 0.6948, Active: 2/2
  FUS/EEA1 - Loss: 0.6643, Acc: 0.6400 
  HSP70/SOD1 - Loss: 0.7254, Acc: 0.5400 
Cell Epoch 3/50, Overall Loss: 0.7552, Active: 2/2
  FUS/EEA1 - Loss: 0.7292, Acc: 0.6000 
  HSP70/SOD1 - Loss: 0.7811, Acc: 0.5267 
Cell Epoch 4/50, Overall Loss: 0.7100, Active: 2/2
  FUS/EEA1 - Loss: 0.6564, Acc: 0.6400 
  HSP70/SOD1 - Loss: 0.7637, Acc: 0.5000 
Cell Epoch 5/50, Overall Loss: 0.6353, Active: 2/2
  FUS/EEA1 - Loss: 0.6124, Acc: 0.6767 
  HSP70/SOD1 - Loss: 0.6583, Acc: 0.6267 
Cell Epoch 6/50, Overall Loss: 0.6617, Active: 2/2
  FUS/EEA1 - Loss: 0.6223, Acc: 0.6950 
  HSP70/SOD1 - Loss: 0.7010, Acc: 0.5433 
Cell Epoch 7/50, Overall Loss: 0.6614, Active: 2/2
  FUS/EEA1 - Loss: 0.6128, Acc: 0.7017 
  HSP70/SOD1 - Loss: 0.7101, Acc: 0.5450 
Cell Epoch 8/50, Overall Loss: 0.6170, Active: 2/2
  FUS/EEA1 - Loss: 0.5710, Acc: 0.7367 
  HSP70/SOD1 - Loss: 0.6631, Acc: 0.6067 
Cell Epoch 9/50, Overall Loss: 0.6742, Active: 2/2
  FUS/EEA1 - Loss: 0.6595, Acc: 0.6650 
  HSP70/SOD1 - Loss: 0.6889, Acc: 0.5650 
Cell Epoch 10/50, Overall Loss: 0.7652, Active: 2/2
  FUS/EEA1 - Loss: 0.7824, Acc: 0.6017 
  HSP70/SOD1 - Loss: 0.7480, Acc: 0.5350 
Cell Epoch 11/50, Overall Loss: 0.6160, Active: 2/2
  FUS/EEA1 - Loss: 0.5759, Acc: 0.7083 
  HSP70/SOD1 - Loss: 0.6561, Acc: 0.6217 
Cell Epoch 12/50, Overall Loss: 0.7100, Active: 2/2
  FUS/EEA1 - Loss: 0.6570, Acc: 0.6350 
  HSP70/SOD1 - Loss: 0.7630, Acc: 0.5017 
Cell Epoch 13/50, Overall Loss: 0.6948, Active: 2/2
  FUS/EEA1 - Loss: 0.6593, Acc: 0.6183 
  HSP70/SOD1 - Loss: 0.7304, Acc: 0.4950 
Cell Epoch 14/50, Overall Loss: 0.6169, Active: 2/2
  FUS/EEA1 - Loss: 0.5469, Acc: 0.7433 
  HSP70/SOD1 - Loss: 0.6869, Acc: 0.5483 
Cell Epoch 15/50, Overall Loss: 0.6828, Active: 2/2
  FUS/EEA1 - Loss: 0.6541, Acc: 0.6167 
  HSP70/SOD1 - Loss: 0.7115, Acc: 0.5433 
Cell Epoch 16/50, Overall Loss: 0.6658, Active: 2/2
  FUS/EEA1 - Loss: 0.6174, Acc: 0.6717 
  HSP70/SOD1 - Loss: 0.7142, Acc: 0.5233 
Cell Epoch 17/50, Overall Loss: 0.7157, Active: 2/2
  FUS/EEA1 - Loss: 0.7193, Acc: 0.5400 
  HSP70/SOD1 - Loss: 0.7120, Acc: 0.5317 
Cell Epoch 18/50, Overall Loss: 0.6242, Active: 2/2
  FUS/EEA1 - Loss: 0.5609, Acc: 0.7150 
  HSP70/SOD1 - Loss: 0.6874, Acc: 0.5683 
Cell Epoch 19/50, Overall Loss: 0.6166, Active: 2/2
  FUS/EEA1 - Loss: 0.5586, Acc: 0.7000 
  HSP70/SOD1 - Loss: 0.6747, Acc: 0.5933 
Cell Epoch 20/50, Overall Loss: 0.6367, Active: 2/2
  FUS/EEA1 - Loss: 0.5696, Acc: 0.7167 
  HSP70/SOD1 - Loss: 0.7038, Acc: 0.5133 
  Freezing HSP70/SOD1 encoder at epoch 21
Cell Epoch 21/50, Overall Loss: 0.6300, Active: 1/2
  FUS/EEA1 - Loss: 0.5891, Acc: 0.7050 
  HSP70/SOD1 - Loss: 0.6709, Acc: 0.5767 [FROZEN]
Cell Epoch 22/50, Overall Loss: 0.6868, Active: 1/2
  FUS/EEA1 - Loss: 0.6868, Acc: 0.6050 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 23/50, Overall Loss: 0.5272, Active: 1/2
  FUS/EEA1 - Loss: 0.5272, Acc: 0.7300 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 24/50, Overall Loss: 0.5717, Active: 1/2
  FUS/EEA1 - Loss: 0.5717, Acc: 0.7133 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 25/50, Overall Loss: 0.6169, Active: 1/2
  FUS/EEA1 - Loss: 0.6169, Acc: 0.6667 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 26/50, Overall Loss: 0.7378, Active: 1/2
  FUS/EEA1 - Loss: 0.7378, Acc: 0.5950 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 27/50, Overall Loss: 0.5398, Active: 1/2
  FUS/EEA1 - Loss: 0.5398, Acc: 0.7250 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 28/50, Overall Loss: 0.6137, Active: 1/2
  FUS/EEA1 - Loss: 0.6137, Acc: 0.6817 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 29/50, Overall Loss: 0.4837, Active: 1/2
  FUS/EEA1 - Loss: 0.4837, Acc: 0.8000 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 30/50, Overall Loss: 0.5592, Active: 1/2
  FUS/EEA1 - Loss: 0.5592, Acc: 0.7300 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 31/50, Overall Loss: 0.5275, Active: 1/2
  FUS/EEA1 - Loss: 0.5275, Acc: 0.7500 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 32/50, Overall Loss: 0.6262, Active: 1/2
  FUS/EEA1 - Loss: 0.6262, Acc: 0.6733 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 33/50, Overall Loss: 0.6293, Active: 1/2
  FUS/EEA1 - Loss: 0.6293, Acc: 0.6333 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 34/50, Overall Loss: 0.6071, Active: 1/2
  FUS/EEA1 - Loss: 0.6071, Acc: 0.6750 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 35/50, Overall Loss: 0.6799, Active: 1/2
  FUS/EEA1 - Loss: 0.6799, Acc: 0.6117 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 36/50, Overall Loss: 0.5644, Active: 1/2
  FUS/EEA1 - Loss: 0.5644, Acc: 0.6967 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 37/50, Overall Loss: 0.5210, Active: 1/2
  FUS/EEA1 - Loss: 0.5210, Acc: 0.7400 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]/awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(

Cell Epoch 38/50, Overall Loss: 0.5721, Active: 1/2
  FUS/EEA1 - Loss: 0.5721, Acc: 0.7117 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  Freezing FUS/EEA1 encoder at epoch 39
Cell Epoch 39/50, Overall Loss: 0.6586, Active: 0/2
  FUS/EEA1 - Loss: 0.6586, Acc: 0.6100 [FROZEN]
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
All antibodies frozen - stopping cell training at epoch 39
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.7325
Line Epoch 2/50, Loss: 0.7013
Line Epoch 3/50, Loss: 0.5313
Line Epoch 4/50, Loss: 1.1338
Line Epoch 5/50, Loss: 0.8069
Line Epoch 6/50, Loss: 0.2577
Line Epoch 7/50, Loss: 0.3142
Line Epoch 8/50, Loss: 0.9318
Line Epoch 9/50, Loss: 0.3660
Line Epoch 10/50, Loss: 0.2844
Line Epoch 11/50, Loss: 0.2451
Line Epoch 12/50, Loss: 0.6527
Line Epoch 13/50, Loss: 0.1805
Line Epoch 14/50, Loss: 0.2677
Line Epoch 15/50, Loss: 0.7143
Line Epoch 16/50, Loss: 0.8539
Line Epoch 17/50, Loss: 0.3576
Line Epoch 18/50, Loss: 0.3466
Line Epoch 19/50, Loss: 0.1944
Line Epoch 20/50, Loss: 0.1502
Line Epoch 21/50, Loss: 0.3030
Line Epoch 22/50, Loss: 0.4218
Line Epoch 23/50, Loss: 0.1552
Line Epoch 24/50, Loss: 0.5246
Line Epoch 25/50, Loss: 0.1560
Line Epoch 26/50, Loss: 0.0881
Line Epoch 27/50, Loss: 0.2666
Line Epoch 28/50, Loss: 0.1951
Line Epoch 29/50, Loss: 0.1280
Line Epoch 30/50, Loss: 0.4336
Line Epoch 31/50, Loss: 0.3347
Line Epoch 32/50, Loss: 0.1098
Line Epoch 33/50, Loss: 0.2572
Line Epoch 34/50, Loss: 0.4318
Line Epoch 35/50, Loss: 0.0943
Line Epoch 36/50, Loss: 0.3408
Early stopping line training at epoch 36
Training completed!
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7461, Active: 2/2
  FUS/EEA1 - Loss: 0.7508, Acc: 0.4878 
  HSP70/SOD1 - Loss: 0.7413, Acc: 0.5256 
Cell Epoch 2/50, Overall Loss: 0.6545, Active: 2/2
  FUS/EEA1 - Loss: 0.6496, Acc: 0.6178 
  HSP70/SOD1 - Loss: 0.6594, Acc: 0.6289 
Cell Epoch 3/50, Overall Loss: 0.6482, Active: 2/2
  FUS/EEA1 - Loss: 0.6046, Acc: 0.6778 
  HSP70/SOD1 - Loss: 0.6918, Acc: 0.5778 
Cell Epoch 4/50, Overall Loss: 0.6262, Active: 2/2
  FUS/EEA1 - Loss: 0.6123, Acc: 0.6900 
  HSP70/SOD1 - Loss: 0.6402, Acc: 0.6500 
Cell Epoch 5/50, Overall Loss: 0.6271, Active: 2/2
  FUS/EEA1 - Loss: 0.6023, Acc: 0.6900 
  HSP70/SOD1 - Loss: 0.6519, Acc: 0.6200 
Cell Epoch 6/50, Overall Loss: 0.5812, Active: 2/2
  FUS/EEA1 - Loss: 0.5509, Acc: 0.7367 
  HSP70/SOD1 - Loss: 0.6114, Acc: 0.6511 
Cell Epoch 7/50, Overall Loss: 0.6011, Active: 2/2
  FUS/EEA1 - Loss: 0.5522, Acc: 0.6933 
  HSP70/SOD1 - Loss: 0.6500, Acc: 0.6356 
Cell Epoch 8/50, Overall Loss: 0.6631, Active: 2/2
  FUS/EEA1 - Loss: 0.6129, Acc: 0.6756 
  HSP70/SOD1 - Loss: 0.7133, Acc: 0.5600 
Cell Epoch 9/50, Overall Loss: 0.6198, Active: 2/2
  FUS/EEA1 - Loss: 0.5785, Acc: 0.7056 
  HSP70/SOD1 - Loss: 0.6612, Acc: 0.6178 
Cell Epoch 10/50, Overall Loss: 0.6378, Active: 2/2
  FUS/EEA1 - Loss: 0.5999, Acc: 0.6700 
  HSP70/SOD1 - Loss: 0.6756, Acc: 0.6078 
Cell Epoch 11/50, Overall Loss: 0.5953, Active: 2/2
  FUS/EEA1 - Loss: 0.5424, Acc: 0.7256 
  HSP70/SOD1 - Loss: 0.6482, Acc: 0.6311 
Cell Epoch 12/50, Overall Loss: 0.6237, Active: 2/2
  FUS/EEA1 - Loss: 0.5837, Acc: 0.6956 
  HSP70/SOD1 - Loss: 0.6637, Acc: 0.5922 
Cell Epoch 13/50, Overall Loss: 0.6335, Active: 2/2
  FUS/EEA1 - Loss: 0.5857, Acc: 0.6989 
  HSP70/SOD1 - Loss: 0.6813, Acc: 0.5811 
Cell Epoch 14/50, Overall Loss: 0.5890, Active: 2/2
  FUS/EEA1 - Loss: 0.5538, Acc: 0.7067 
  HSP70/SOD1 - Loss: 0.6242, Acc: 0.6400 
Cell Epoch 15/50, Overall Loss: 0.5885, Active: 2/2
  FUS/EEA1 - Loss: 0.5485, Acc: 0.7478 
  HSP70/SOD1 - Loss: 0.6286, Acc: 0.6422 
  Freezing HSP70/SOD1 encoder at epoch 16
Cell Epoch 16/50, Overall Loss: 0.7207, Active: 1/2
  FUS/EEA1 - Loss: 0.7026, Acc: 0.6133 
  HSP70/SOD1 - Loss: 0.7389, Acc: 0.5122 [FROZEN]
Cell Epoch 17/50, Overall Loss: 0.5938, Active: 1/2
  FUS/EEA1 - Loss: 0.5938, Acc: 0.7011 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 18/50, Overall Loss: 0.6435, Active: 1/2
  FUS/EEA1 - Loss: 0.6435, Acc: 0.6522 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 19/50, Overall Loss: 0.7207, Active: 1/2
  FUS/EEA1 - Loss: 0.7207, Acc: 0.6100 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 20/50, Overall Loss: 0.5790, Active: 1/2
  FUS/EEA1 - Loss: 0.5790, Acc: 0.6822 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  Freezing FUS/EEA1 encoder at epoch 21
Cell Epoch 21/50, Overall Loss: 0.6168, Active: 0/2
  FUS/EEA1 - Loss: 0.6168, Acc: 0.6500 [FROZEN]
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
All antibodies frozen - stopping cell training at epoch 21
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.9088
Line Epoch 2/50, Loss: 0.5627
Line Epoch 3/50, Loss: 0.8730
Line Epoch 4/50, Loss: 0.4046
Line Epoch 5/50, Loss: 0.7995
Line Epoch 6/50, Loss: 0.8493
Line Epoch 7/50, Loss: 0.4695
Line Epoch 8/50, Loss: 0.7832
Line Epoch 9/50, Loss: 0.1379
Line Epoch 10/50, Loss: 0.1252
Line Epoch 11/50, Loss: 0.3678
Line Epoch 12/50, Loss: 0.1977
Line Epoch 13/50, Loss: 0.1920
Line Epoch 14/50, Loss: 0.1254
Line Epoch 15/50, Loss: 0.2113
Line Epoch 16/50, Loss: 0.2927
Line Epoch 17/50, Loss: 0.1409
Line Epoch 18/50, Loss: 0.1948
Line Epoch 19/50, Loss: 0.1387
Line Epoch 20/50, Loss: 0.0939
Line Epoch 21/50, Loss: 0.5020
Line Epoch 22/50, Loss: 0.1696
Line Epoch 23/50, Loss: 0.1451
Line Epoch 24/50, Loss: 0.1693
Line Epoch 25/50, Loss: 0.1959
Line Epoch 26/50, Loss: 0.1738
Line Epoch 27/50, Loss: 0.2760
Line Epoch 28/50, Loss: 0.2660
Line Epoch 29/50, Loss: 0.2293
Line Epoch 30/50, Loss: 0.1469
Early stopping line training at epoch 30
Training completed!
Running replicate 3/50
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7482, Active: 2/2
  FUS/EEA1 - Loss: 0.7627, Acc: 0.4983 
  HSP70/SOD1 - Loss: 0.7337, Acc: 0.5467 
Cell Epoch 2/50, Overall Loss: 0.7380, Active: 2/2
  FUS/EEA1 - Loss: 0.7297, Acc: 0.5867 
  HSP70/SOD1 - Loss: 0.7464, Acc: 0.5433 
Cell Epoch 3/50, Overall Loss: 0.6817, Active: 2/2
  FUS/EEA1 - Loss: 0.5826, Acc: 0.6883 
  HSP70/SOD1 - Loss: 0.7808, Acc: 0.5000 
Cell Epoch 4/50, Overall Loss: 0.6881, Active: 2/2
  FUS/EEA1 - Loss: 0.7001, Acc: 0.6000 
  HSP70/SOD1 - Loss: 0.6760, Acc: 0.6017 
Cell Epoch 5/50, Overall Loss: 0.7331, Active: 2/2
  FUS/EEA1 - Loss: 0.7233, Acc: 0.5950 
  HSP70/SOD1 - Loss: 0.7429, Acc: 0.5083 
Cell Epoch 6/50, Overall Loss: 0.6450, Active: 2/2
  FUS/EEA1 - Loss: 0.5897, Acc: 0.7050 
  HSP70/SOD1 - Loss: 0.7003, Acc: 0.5833 
Cell Epoch 7/50, Overall Loss: 0.6684, Active: 2/2
  FUS/EEA1 - Loss: 0.6131, Acc: 0.7217 
  HSP70/SOD1 - Loss: 0.7237, Acc: 0.5250 
Cell Epoch 8/50, Overall Loss: 0.7312, Active: 2/2
  FUS/EEA1 - Loss: 0.7362, Acc: 0.5967 
  HSP70/SOD1 - Loss: 0.7263, Acc: 0.5300 
Cell Epoch 9/50, Overall Loss: 0.6641, Active: 2/2
  FUS/EEA1 - Loss: 0.6141, Acc: 0.6633 
  HSP70/SOD1 - Loss: 0.7140, Acc: 0.5300 
Cell Epoch 10/50, Overall Loss: 0.6308, Active: 2/2
  FUS/EEA1 - Loss: 0.5786, Acc: 0.6967 
  HSP70/SOD1 - Loss: 0.6830, Acc: 0.5883 
Cell Epoch 11/50, Overall Loss: 0.6150, Active: 2/2
  FUS/EEA1 - Loss: 0.5590, Acc: 0.7100 
  HSP70/SOD1 - Loss: 0.6711, Acc: 0.5783 
Cell Epoch 12/50, Overall Loss: 0.7080, Active: 2/2
  FUS/EEA1 - Loss: 0.6913, Acc: 0.5933 
  HSP70/SOD1 - Loss: 0.7248, Acc: 0.5350 
Cell Epoch 13/50, Overall Loss: 0.6542, Active: 2/2
  FUS/EEA1 - Loss: 0.6128, Acc: 0.6700 
  HSP70/SOD1 - Loss: 0.6955, Acc: 0.5583 
Cell Epoch 14/50, Overall Loss: 0.6407, Active: 2/2
  FUS/EEA1 - Loss: 0.5777, Acc: 0.7200 
  HSP70/SOD1 - Loss: 0.7036, Acc: 0.5617 
Cell Epoch 15/50, Overall Loss: 0.6340, Active: 2/2
  FUS/EEA1 - Loss: 0.6228, Acc: 0.6700 
  HSP70/SOD1 - Loss: 0.6452, Acc: 0.6167 
Cell Epoch 16/50, Overall Loss: 0.5848, Active: 2/2
  FUS/EEA1 - Loss: 0.4912, Acc: 0.7867 
  HSP70/SOD1 - Loss: 0.6784, Acc: 0.5867 
Cell Epoch 17/50, Overall Loss: 0.6307, Active: 2/2
  FUS/EEA1 - Loss: 0.5621, Acc: 0.6950 
  HSP70/SOD1 - Loss: 0.6993, Acc: 0.5733 
Cell Epoch 18/50, Overall Loss: 0.6356, Active: 2/2
  FUS/EEA1 - Loss: 0.5694, Acc: 0.7300 
  HSP70/SOD1 - Loss: 0.7017, Acc: 0.5417 /awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
/awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(

Cell Epoch 19/50, Overall Loss: 0.6364, Active: 2/2
  FUS/EEA1 - Loss: 0.5861, Acc: 0.7067 
  HSP70/SOD1 - Loss: 0.6867, Acc: 0.5550 
Cell Epoch 20/50, Overall Loss: 0.5936, Active: 2/2
  FUS/EEA1 - Loss: 0.5316, Acc: 0.7483 
  HSP70/SOD1 - Loss: 0.6555, Acc: 0.5967 
Cell Epoch 21/50, Overall Loss: 0.6357, Active: 2/2
  FUS/EEA1 - Loss: 0.6117, Acc: 0.6550 
  HSP70/SOD1 - Loss: 0.6596, Acc: 0.5933 
Cell Epoch 22/50, Overall Loss: 0.6664, Active: 2/2
  FUS/EEA1 - Loss: 0.6378, Acc: 0.6450 
  HSP70/SOD1 - Loss: 0.6949, Acc: 0.5783 
Cell Epoch 23/50, Overall Loss: 0.6215, Active: 2/2
  FUS/EEA1 - Loss: 0.5854, Acc: 0.6733 
  HSP70/SOD1 - Loss: 0.6576, Acc: 0.5933 
Cell Epoch 24/50, Overall Loss: 0.6377, Active: 2/2
  FUS/EEA1 - Loss: 0.5810, Acc: 0.6950 
  HSP70/SOD1 - Loss: 0.6944, Acc: 0.5400 
  Freezing HSP70/SOD1 encoder at epoch 25
Cell Epoch 25/50, Overall Loss: 0.6681, Active: 1/2
  FUS/EEA1 - Loss: 0.5969, Acc: 0.6767 
  HSP70/SOD1 - Loss: 0.7394, Acc: 0.5033 [FROZEN]
  Freezing FUS/EEA1 encoder at epoch 26
Cell Epoch 26/50, Overall Loss: 0.6360, Active: 0/2
  FUS/EEA1 - Loss: 0.6360, Acc: 0.6617 [FROZEN]
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
All antibodies frozen - stopping cell training at epoch 26
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.7829
Line Epoch 2/50, Loss: 0.7026
Line Epoch 3/50, Loss: 0.4668
Line Epoch 4/50, Loss: 0.5856
Line Epoch 5/50, Loss: 0.2061
Line Epoch 6/50, Loss: 0.3517
Line Epoch 7/50, Loss: 0.4931
Line Epoch 8/50, Loss: 0.4362
Line Epoch 9/50, Loss: 0.1596
Line Epoch 10/50, Loss: 0.6368
Line Epoch 11/50, Loss: 0.2137
Line Epoch 12/50, Loss: 0.0734
Line Epoch 13/50, Loss: 0.5570
Line Epoch 14/50, Loss: 0.5937
Line Epoch 15/50, Loss: 0.1755
Line Epoch 16/50, Loss: 0.3039
Line Epoch 17/50, Loss: 0.1655
Line Epoch 18/50, Loss: 0.0644
Line Epoch 19/50, Loss: 0.3352
Line Epoch 20/50, Loss: 0.3163
Line Epoch 21/50, Loss: 0.1640
Line Epoch 22/50, Loss: 0.5369
Line Epoch 23/50, Loss: 0.2353
Line Epoch 24/50, Loss: 0.3828
Line Epoch 25/50, Loss: 0.4201
Line Epoch 26/50, Loss: 0.1967
Line Epoch 27/50, Loss: 0.0333
Line Epoch 28/50, Loss: 0.3990
Line Epoch 29/50, Loss: 0.2300
Line Epoch 30/50, Loss: 0.1322
Line Epoch 31/50, Loss: 0.4495
Line Epoch 32/50, Loss: 0.3265
Line Epoch 33/50, Loss: 0.2610
Line Epoch 34/50, Loss: 0.1945
Line Epoch 35/50, Loss: 0.7375
Line Epoch 36/50, Loss: 0.1413
Line Epoch 37/50, Loss: 0.0683
Early stopping line training at epoch 37
Training completed!
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7341, Active: 2/2
  FUS/EEA1 - Loss: 0.7092, Acc: 0.5700 
  HSP70/SOD1 - Loss: 0.7589, Acc: 0.4822 
Cell Epoch 2/50, Overall Loss: 0.7520, Active: 2/2
  FUS/EEA1 - Loss: 0.7466, Acc: 0.5678 
  HSP70/SOD1 - Loss: 0.7574, Acc: 0.5133 
Cell Epoch 3/50, Overall Loss: 0.6599, Active: 2/2
  FUS/EEA1 - Loss: 0.6513, Acc: 0.6278 
  HSP70/SOD1 - Loss: 0.6686, Acc: 0.5989 
Cell Epoch 4/50, Overall Loss: 0.6689, Active: 2/2
  FUS/EEA1 - Loss: 0.6337, Acc: 0.6456 
  HSP70/SOD1 - Loss: 0.7041, Acc: 0.5500 
Cell Epoch 5/50, Overall Loss: 0.6218, Active: 2/2
  FUS/EEA1 - Loss: 0.5641, Acc: 0.7156 
  HSP70/SOD1 - Loss: 0.6795, Acc: 0.5889 
Cell Epoch 6/50, Overall Loss: 0.5673, Active: 2/2
  FUS/EEA1 - Loss: 0.5412, Acc: 0.7189 
  HSP70/SOD1 - Loss: 0.5933, Acc: 0.6589 
Cell Epoch 7/50, Overall Loss: 0.6357, Active: 2/2
  FUS/EEA1 - Loss: 0.6044, Acc: 0.6922 
  HSP70/SOD1 - Loss: 0.6669, Acc: 0.6022 
Cell Epoch 8/50, Overall Loss: 0.6499, Active: 2/2
  FUS/EEA1 - Loss: 0.6422, Acc: 0.6756 
  HSP70/SOD1 - Loss: 0.6577, Acc: 0.6211 
Cell Epoch 9/50, Overall Loss: 0.6037, Active: 2/2
  FUS/EEA1 - Loss: 0.5604, Acc: 0.6889 
  HSP70/SOD1 - Loss: 0.6470, Acc: 0.6167 
Cell Epoch 10/50, Overall Loss: 0.6046, Active: 2/2
  FUS/EEA1 - Loss: 0.5658, Acc: 0.7133 
  HSP70/SOD1 - Loss: 0.6435, Acc: 0.6289 
Cell Epoch 11/50, Overall Loss: 0.6051, Active: 2/2
  FUS/EEA1 - Loss: 0.5704, Acc: 0.7011 
  HSP70/SOD1 - Loss: 0.6397, Acc: 0.6444 
Cell Epoch 12/50, Overall Loss: 0.5960, Active: 2/2
  FUS/EEA1 - Loss: 0.5212, Acc: 0.7500 
  HSP70/SOD1 - Loss: 0.6709, Acc: 0.6156 
Cell Epoch 13/50, Overall Loss: 0.6668, Active: 2/2
  FUS/EEA1 - Loss: 0.6656, Acc: 0.6211 
  HSP70/SOD1 - Loss: 0.6681, Acc: 0.5989 
Cell Epoch 14/50, Overall Loss: 0.5876, Active: 2/2
  FUS/EEA1 - Loss: 0.5521, Acc: 0.7156 
  HSP70/SOD1 - Loss: 0.6231, Acc: 0.6356 
Cell Epoch 15/50, Overall Loss: 0.5848, Active: 2/2
  FUS/EEA1 - Loss: 0.5398, Acc: 0.6978 
  HSP70/SOD1 - Loss: 0.6298, Acc: 0.6333 
  Freezing HSP70/SOD1 encoder at epoch 16
Cell Epoch 16/50, Overall Loss: 0.5699, Active: 1/2
  FUS/EEA1 - Loss: 0.5349, Acc: 0.7278 
  HSP70/SOD1 - Loss: 0.6049, Acc: 0.6633 [FROZEN]
Cell Epoch 17/50, Overall Loss: 0.6013, Active: 1/2
  FUS/EEA1 - Loss: 0.6013, Acc: 0.6756 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 18/50, Overall Loss: 0.5349, Active: 1/2
  FUS/EEA1 - Loss: 0.5349, Acc: 0.6978 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 19/50, Overall Loss: 0.5644, Active: 1/2
  FUS/EEA1 - Loss: 0.5644, Acc: 0.6967 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 20/50, Overall Loss: 0.7118, Active: 1/2
  FUS/EEA1 - Loss: 0.7118, Acc: 0.6144 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 21/50, Overall Loss: 0.5475, Active: 1/2
  FUS/EEA1 - Loss: 0.5475, Acc: 0.7267 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  Freezing FUS/EEA1 encoder at epoch 22
Cell Epoch 22/50, Overall Loss: 0.5791, Active: 0/2
  FUS/EEA1 - Loss: 0.5791, Acc: 0.6900 [FROZEN]
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
All antibodies frozen - stopping cell training at epoch 22
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.9089
Line Epoch 2/50, Loss: 0.7064
Line Epoch 3/50, Loss: 0.3540
Line Epoch 4/50, Loss: 0.2022
Line Epoch 5/50, Loss: 0.2448
Line Epoch 6/50, Loss: 0.6655
Line Epoch 7/50, Loss: 0.6849
Line Epoch 8/50, Loss: 0.3635
Line Epoch 9/50, Loss: 0.3417
Line Epoch 10/50, Loss: 0.2856
Line Epoch 11/50, Loss: 0.2168
Line Epoch 12/50, Loss: 0.6652
Line Epoch 13/50, Loss: 0.0714
Line Epoch 14/50, Loss: 0.2302
Line Epoch 15/50, Loss: 0.4455
Line Epoch 16/50, Loss: 0.2112
Line Epoch 17/50, Loss: 0.2120
Line Epoch 18/50, Loss: 0.3014
Line Epoch 19/50, Loss: 0.2623
Line Epoch 20/50, Loss: 0.3095
Line Epoch 21/50, Loss: 0.3135
Line Epoch 22/50, Loss: 0.0396
Line Epoch 23/50, Loss: 0.3180
Line Epoch 24/50, Loss: 0.1024
Line Epoch 25/50, Loss: 0.1668
Line Epoch 26/50, Loss: 0.0876
Line Epoch 27/50, Loss: 0.2964
Line Epoch 28/50, Loss: 0.3029
Line Epoch 29/50, Loss: 0.1943
Line Epoch 30/50, Loss: 0.1289
Line Epoch 31/50, Loss: 0.1600
Line Epoch 32/50, Loss: 0.3016
Early stopping line training at epoch 32
Training completed!
Running replicate 4/50
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7600, Active: 2/2
  FUS/EEA1 - Loss: 0.7648, Acc: 0.4867 
  HSP70/SOD1 - Loss: 0.7552, Acc: 0.5083 
Cell Epoch 2/50, Overall Loss: 0.7445, Active: 2/2
  FUS/EEA1 - Loss: 0.7132, Acc: 0.5633 
  HSP70/SOD1 - Loss: 0.7758, Acc: 0.5233 
Cell Epoch 3/50, Overall Loss: 0.7304, Active: 2/2
  FUS/EEA1 - Loss: 0.7062, Acc: 0.5817 
  HSP70/SOD1 - Loss: 0.7545, Acc: 0.4983 
Cell Epoch 4/50, Overall Loss: 0.6945, Active: 2/2
  FUS/EEA1 - Loss: 0.6503, Acc: 0.6500 
  HSP70/SOD1 - Loss: 0.7388, Acc: 0.5250 
Cell Epoch 5/50, Overall Loss: 0.6863, Active: 2/2
  FUS/EEA1 - Loss: 0.6656, Acc: 0.6117 
  HSP70/SOD1 - Loss: 0.7071, Acc: 0.5517 
Cell Epoch 6/50, Overall Loss: 0.7080, Active: 2/2
  FUS/EEA1 - Loss: 0.6903, Acc: 0.6117 
  HSP70/SOD1 - Loss: 0.7258, Acc: 0.5117 
Cell Epoch 7/50, Overall Loss: 0.7441, Active: 2/2
  FUS/EEA1 - Loss: 0.7316, Acc: 0.5667 
  HSP70/SOD1 - Loss: 0.7566, Acc: 0.4617 
Cell Epoch 8/50, Overall Loss: 0.6235, Active: 2/2
  FUS/EEA1 - Loss: 0.5575, Acc: 0.7333 
  HSP70/SOD1 - Loss: 0.6895, Acc: 0.5250 
Cell Epoch 9/50, Overall Loss: 0.6549, Active: 2/2
  FUS/EEA1 - Loss: 0.6084, Acc: 0.6883 
  HSP70/SOD1 - Loss: 0.7015, Acc: 0.5317 
Cell Epoch 10/50, Overall Loss: 0.7223, Active: 2/2
  FUS/EEA1 - Loss: 0.7380, Acc: 0.5850 
  HSP70/SOD1 - Loss: 0.7066, Acc: 0.5067 /awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
/awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(

Cell Epoch 11/50, Overall Loss: 0.6570, Active: 2/2
  FUS/EEA1 - Loss: 0.6229, Acc: 0.6483 
  HSP70/SOD1 - Loss: 0.6912, Acc: 0.5267 
Cell Epoch 12/50, Overall Loss: 0.6372, Active: 2/2
  FUS/EEA1 - Loss: 0.6080, Acc: 0.6733 
  HSP70/SOD1 - Loss: 0.6663, Acc: 0.5850 
Cell Epoch 13/50, Overall Loss: 0.6189, Active: 2/2
  FUS/EEA1 - Loss: 0.5385, Acc: 0.7717 
  HSP70/SOD1 - Loss: 0.6992, Acc: 0.5733 
Cell Epoch 14/50, Overall Loss: 0.6396, Active: 2/2
  FUS/EEA1 - Loss: 0.5552, Acc: 0.7000 
  HSP70/SOD1 - Loss: 0.7240, Acc: 0.5283 
Cell Epoch 15/50, Overall Loss: 0.6699, Active: 2/2
  FUS/EEA1 - Loss: 0.6112, Acc: 0.6817 
  HSP70/SOD1 - Loss: 0.7287, Acc: 0.5133 
Cell Epoch 16/50, Overall Loss: 0.6217, Active: 2/2
  FUS/EEA1 - Loss: 0.5390, Acc: 0.7317 
  HSP70/SOD1 - Loss: 0.7043, Acc: 0.5350 
Cell Epoch 17/50, Overall Loss: 0.5838, Active: 2/2
  FUS/EEA1 - Loss: 0.4895, Acc: 0.7550 
  HSP70/SOD1 - Loss: 0.6780, Acc: 0.5667 
Cell Epoch 18/50, Overall Loss: 0.6772, Active: 2/2
  FUS/EEA1 - Loss: 0.6397, Acc: 0.6450 
  HSP70/SOD1 - Loss: 0.7146, Acc: 0.4917 
Cell Epoch 19/50, Overall Loss: 0.6314, Active: 2/2
  FUS/EEA1 - Loss: 0.5829, Acc: 0.6967 
  HSP70/SOD1 - Loss: 0.6799, Acc: 0.5683 
Cell Epoch 20/50, Overall Loss: 0.6618, Active: 2/2
  FUS/EEA1 - Loss: 0.6178, Acc: 0.6400 
  HSP70/SOD1 - Loss: 0.7057, Acc: 0.5183 
Cell Epoch 21/50, Overall Loss: 0.6453, Active: 2/2
  FUS/EEA1 - Loss: 0.5923, Acc: 0.7033 
  HSP70/SOD1 - Loss: 0.6983, Acc: 0.5483 
Cell Epoch 22/50, Overall Loss: 0.6089, Active: 2/2
  FUS/EEA1 - Loss: 0.5602, Acc: 0.7233 
  HSP70/SOD1 - Loss: 0.6576, Acc: 0.5967 
Cell Epoch 23/50, Overall Loss: 0.6310, Active: 2/2
  FUS/EEA1 - Loss: 0.5780, Acc: 0.7217 
  HSP70/SOD1 - Loss: 0.6841, Acc: 0.5717 
Cell Epoch 24/50, Overall Loss: 0.6437, Active: 2/2
  FUS/EEA1 - Loss: 0.6111, Acc: 0.6933 
  HSP70/SOD1 - Loss: 0.6762, Acc: 0.5550 
Cell Epoch 25/50, Overall Loss: 0.6030, Active: 2/2
  FUS/EEA1 - Loss: 0.5473, Acc: 0.7083 
  HSP70/SOD1 - Loss: 0.6587, Acc: 0.5850 
Cell Epoch 26/50, Overall Loss: 0.6438, Active: 2/2
  FUS/EEA1 - Loss: 0.5766, Acc: 0.7150 
  HSP70/SOD1 - Loss: 0.7110, Acc: 0.5000 
  Freezing FUS/EEA1 encoder at epoch 27
Cell Epoch 27/50, Overall Loss: 0.6258, Active: 1/2
  FUS/EEA1 - Loss: 0.5724, Acc: 0.7200 [FROZEN]
  HSP70/SOD1 - Loss: 0.6791, Acc: 0.5717 
Cell Epoch 28/50, Overall Loss: 0.7578, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7578, Acc: 0.4967 
Cell Epoch 29/50, Overall Loss: 0.7545, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7545, Acc: 0.4867 
Cell Epoch 30/50, Overall Loss: 0.7110, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7110, Acc: 0.5100 
Cell Epoch 31/50, Overall Loss: 0.7353, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7353, Acc: 0.5167 
  Freezing HSP70/SOD1 encoder at epoch 32
Cell Epoch 32/50, Overall Loss: 0.7221, Active: 0/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7221, Acc: 0.5083 [FROZEN]
All antibodies frozen - stopping cell training at epoch 32
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.8271
Line Epoch 2/50, Loss: 0.4238
Line Epoch 3/50, Loss: 1.1278
Line Epoch 4/50, Loss: 0.9338
Line Epoch 5/50, Loss: 0.2968
Line Epoch 6/50, Loss: 0.4849
Line Epoch 7/50, Loss: 0.2940
Line Epoch 8/50, Loss: 0.4358
Line Epoch 9/50, Loss: 0.6440
Line Epoch 10/50, Loss: 0.4105
Line Epoch 11/50, Loss: 0.8953
Line Epoch 12/50, Loss: 0.3715
Line Epoch 13/50, Loss: 0.7905
Line Epoch 14/50, Loss: 0.1661
Line Epoch 15/50, Loss: 0.4515
Line Epoch 16/50, Loss: 0.0431
Line Epoch 17/50, Loss: 0.1940
Line Epoch 18/50, Loss: 0.1245
Line Epoch 19/50, Loss: 0.1124
Line Epoch 20/50, Loss: 0.2636
Line Epoch 21/50, Loss: 0.4203
Line Epoch 22/50, Loss: 0.1239
Line Epoch 23/50, Loss: 0.1444
Line Epoch 24/50, Loss: 0.0626
Line Epoch 25/50, Loss: 0.1270
Line Epoch 26/50, Loss: 0.2991
Early stopping line training at epoch 26
Training completed!
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7518, Active: 2/2
  FUS/EEA1 - Loss: 0.7389, Acc: 0.5356 
  HSP70/SOD1 - Loss: 0.7647, Acc: 0.4833 
Cell Epoch 2/50, Overall Loss: 0.7056, Active: 2/2
  FUS/EEA1 - Loss: 0.6925, Acc: 0.6000 
  HSP70/SOD1 - Loss: 0.7187, Acc: 0.5367 
Cell Epoch 3/50, Overall Loss: 0.6932, Active: 2/2
  FUS/EEA1 - Loss: 0.6333, Acc: 0.6311 
  HSP70/SOD1 - Loss: 0.7531, Acc: 0.5122 
Cell Epoch 4/50, Overall Loss: 0.6317, Active: 2/2
  FUS/EEA1 - Loss: 0.5988, Acc: 0.6811 
  HSP70/SOD1 - Loss: 0.6646, Acc: 0.5989 
Cell Epoch 5/50, Overall Loss: 0.6174, Active: 2/2
  FUS/EEA1 - Loss: 0.5787, Acc: 0.6978 
  HSP70/SOD1 - Loss: 0.6560, Acc: 0.6156 
Cell Epoch 6/50, Overall Loss: 0.6389, Active: 2/2
  FUS/EEA1 - Loss: 0.6144, Acc: 0.6622 
  HSP70/SOD1 - Loss: 0.6634, Acc: 0.5767 
Cell Epoch 7/50, Overall Loss: 0.7339, Active: 2/2
  FUS/EEA1 - Loss: 0.7616, Acc: 0.5644 
  HSP70/SOD1 - Loss: 0.7061, Acc: 0.5600 
Cell Epoch 8/50, Overall Loss: 0.6334, Active: 2/2
  FUS/EEA1 - Loss: 0.5911, Acc: 0.6956 
  HSP70/SOD1 - Loss: 0.6756, Acc: 0.6222 
Cell Epoch 9/50, Overall Loss: 0.6962, Active: 2/2
  FUS/EEA1 - Loss: 0.7407, Acc: 0.5844 
  HSP70/SOD1 - Loss: 0.6517, Acc: 0.5811 
Cell Epoch 10/50, Overall Loss: 0.6483, Active: 2/2
  FUS/EEA1 - Loss: 0.6142, Acc: 0.6544 
  HSP70/SOD1 - Loss: 0.6823, Acc: 0.5844 
Cell Epoch 11/50, Overall Loss: 0.6443, Active: 2/2
  FUS/EEA1 - Loss: 0.6155, Acc: 0.6667 
  HSP70/SOD1 - Loss: 0.6732, Acc: 0.5856 
Cell Epoch 12/50, Overall Loss: 0.6066, Active: 2/2
  FUS/EEA1 - Loss: 0.5616, Acc: 0.7044 
  HSP70/SOD1 - Loss: 0.6517, Acc: 0.6167 
Cell Epoch 13/50, Overall Loss: 0.5812, Active: 2/2
  FUS/EEA1 - Loss: 0.5172, Acc: 0.7556 
  HSP70/SOD1 - Loss: 0.6452, Acc: 0.6278 
Cell Epoch 14/50, Overall Loss: 0.6085, Active: 2/2
  FUS/EEA1 - Loss: 0.5689, Acc: 0.7211 
  HSP70/SOD1 - Loss: 0.6482, Acc: 0.6178 
Cell Epoch 15/50, Overall Loss: 0.5985, Active: 2/2
  FUS/EEA1 - Loss: 0.5450, Acc: 0.7356 
  HSP70/SOD1 - Loss: 0.6520, Acc: 0.6233 
Cell Epoch 16/50, Overall Loss: 0.6423, Active: 2/2
  FUS/EEA1 - Loss: 0.6068, Acc: 0.6611 
  HSP70/SOD1 - Loss: 0.6777, Acc: 0.5800 
Cell Epoch 17/50, Overall Loss: 0.5913, Active: 2/2
  FUS/EEA1 - Loss: 0.5452, Acc: 0.7144 
  HSP70/SOD1 - Loss: 0.6375, Acc: 0.6533 
Cell Epoch 18/50, Overall Loss: 0.5922, Active: 2/2
  FUS/EEA1 - Loss: 0.5546, Acc: 0.7167 
  HSP70/SOD1 - Loss: 0.6298, Acc: 0.6456 
Cell Epoch 19/50, Overall Loss: 0.6163, Active: 2/2
  FUS/EEA1 - Loss: 0.5904, Acc: 0.6589 
  HSP70/SOD1 - Loss: 0.6422, Acc: 0.6289 
Cell Epoch 20/50, Overall Loss: 0.6006, Active: 2/2
  FUS/EEA1 - Loss: 0.5491, Acc: 0.7122 
  HSP70/SOD1 - Loss: 0.6521, Acc: 0.6111 
Cell Epoch 21/50, Overall Loss: 0.6458, Active: 2/2
  FUS/EEA1 - Loss: 0.6435, Acc: 0.6478 
  HSP70/SOD1 - Loss: 0.6481, Acc: 0.6222 
Cell Epoch 22/50, Overall Loss: 0.6462, Active: 2/2
  FUS/EEA1 - Loss: 0.6248, Acc: 0.6800 
  HSP70/SOD1 - Loss: 0.6676, Acc: 0.5856 
  Freezing FUS/EEA1 encoder at epoch 23
Cell Epoch 23/50, Overall Loss: 0.5800, Active: 1/2
  FUS/EEA1 - Loss: 0.5217, Acc: 0.7467 [FROZEN]
  HSP70/SOD1 - Loss: 0.6383, Acc: 0.6233 
Cell Epoch 24/50, Overall Loss: 0.6136, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6136, Acc: 0.6689 
Cell Epoch 25/50, Overall Loss: 0.6832, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6832, Acc: 0.6178 
Cell Epoch 26/50, Overall Loss: 0.6678, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6678, Acc: 0.5967 
Cell Epoch 27/50, Overall Loss: 0.6997, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6997, Acc: 0.5600 
Cell Epoch 28/50, Overall Loss: 0.6811, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6811, Acc: 0.6033 
Cell Epoch 29/50, Overall Loss: 0.6356, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6356, Acc: 0.6400 
Cell Epoch 30/50, Overall Loss: 0.6269, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]/awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(

  HSP70/SOD1 - Loss: 0.6269, Acc: 0.6522 
Cell Epoch 31/50, Overall Loss: 0.7609, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7609, Acc: 0.5156 
Cell Epoch 32/50, Overall Loss: 0.6617, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6617, Acc: 0.6044 
Cell Epoch 33/50, Overall Loss: 0.6399, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6399, Acc: 0.6344 
  Freezing HSP70/SOD1 encoder at epoch 34
Cell Epoch 34/50, Overall Loss: 0.6295, Active: 0/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6295, Acc: 0.6278 [FROZEN]
All antibodies frozen - stopping cell training at epoch 34
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.6583
Line Epoch 2/50, Loss: 0.7859
Line Epoch 3/50, Loss: 0.5597
Line Epoch 4/50, Loss: 1.1777
Line Epoch 5/50, Loss: 0.5008
Line Epoch 6/50, Loss: 0.3533
Line Epoch 7/50, Loss: 0.1558
Line Epoch 8/50, Loss: 0.7116
Line Epoch 9/50, Loss: 0.1802
Line Epoch 10/50, Loss: 0.3977
Line Epoch 11/50, Loss: 0.2516
Line Epoch 12/50, Loss: 0.2976
Line Epoch 13/50, Loss: 0.1316
Line Epoch 14/50, Loss: 0.2707
Line Epoch 15/50, Loss: 0.2820
Line Epoch 16/50, Loss: 0.2182
Line Epoch 17/50, Loss: 0.2865
Line Epoch 18/50, Loss: 0.2272
Line Epoch 19/50, Loss: 0.1775
Line Epoch 20/50, Loss: 0.1723
Line Epoch 21/50, Loss: 0.2357
Line Epoch 22/50, Loss: 0.1039
Line Epoch 23/50, Loss: 0.3082
Line Epoch 24/50, Loss: 0.0554
Line Epoch 25/50, Loss: 0.4356
Line Epoch 26/50, Loss: 0.0551
Line Epoch 27/50, Loss: 0.1808
Line Epoch 28/50, Loss: 0.1229
Line Epoch 29/50, Loss: 0.2080
Line Epoch 30/50, Loss: 0.1449
Line Epoch 31/50, Loss: 0.1323
Line Epoch 32/50, Loss: 0.1300
Line Epoch 33/50, Loss: 0.1205
Line Epoch 34/50, Loss: 0.1516
Line Epoch 35/50, Loss: 0.1827
Line Epoch 36/50, Loss: 0.1509
Early stopping line training at epoch 36
Training completed!
Running replicate 5/50
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7808, Active: 2/2
  FUS/EEA1 - Loss: 0.8032, Acc: 0.5200 
  HSP70/SOD1 - Loss: 0.7585, Acc: 0.4867 
Cell Epoch 2/50, Overall Loss: 0.7646, Active: 2/2
  FUS/EEA1 - Loss: 0.7305, Acc: 0.5600 
  HSP70/SOD1 - Loss: 0.7988, Acc: 0.4600 
Cell Epoch 3/50, Overall Loss: 0.6753, Active: 2/2
  FUS/EEA1 - Loss: 0.6260, Acc: 0.6617 
  HSP70/SOD1 - Loss: 0.7245, Acc: 0.5450 
Cell Epoch 4/50, Overall Loss: 0.6668, Active: 2/2
  FUS/EEA1 - Loss: 0.6222, Acc: 0.6683 
  HSP70/SOD1 - Loss: 0.7114, Acc: 0.5283 
Cell Epoch 5/50, Overall Loss: 0.6760, Active: 2/2
  FUS/EEA1 - Loss: 0.6409, Acc: 0.6483 
  HSP70/SOD1 - Loss: 0.7111, Acc: 0.5500 
Cell Epoch 6/50, Overall Loss: 0.6353, Active: 2/2
  FUS/EEA1 - Loss: 0.5767, Acc: 0.6983 
  HSP70/SOD1 - Loss: 0.6939, Acc: 0.5833 
Cell Epoch 7/50, Overall Loss: 0.6490, Active: 2/2
  FUS/EEA1 - Loss: 0.5711, Acc: 0.7317 
  HSP70/SOD1 - Loss: 0.7269, Acc: 0.5067 
Cell Epoch 8/50, Overall Loss: 0.6553, Active: 2/2
  FUS/EEA1 - Loss: 0.5909, Acc: 0.7033 
  HSP70/SOD1 - Loss: 0.7196, Acc: 0.5500 
Cell Epoch 9/50, Overall Loss: 0.6877, Active: 2/2
  FUS/EEA1 - Loss: 0.6529, Acc: 0.6683 
  HSP70/SOD1 - Loss: 0.7226, Acc: 0.5433 
Cell Epoch 10/50, Overall Loss: 0.7018, Active: 2/2
  FUS/EEA1 - Loss: 0.6838, Acc: 0.6333 
  HSP70/SOD1 - Loss: 0.7198, Acc: 0.4967 
Cell Epoch 11/50, Overall Loss: 0.6891, Active: 2/2
  FUS/EEA1 - Loss: 0.6595, Acc: 0.6533 
  HSP70/SOD1 - Loss: 0.7187, Acc: 0.5083 
Cell Epoch 12/50, Overall Loss: 0.6581, Active: 2/2
  FUS/EEA1 - Loss: 0.6272, Acc: 0.7117 
  HSP70/SOD1 - Loss: 0.6889, Acc: 0.5533 
Cell Epoch 13/50, Overall Loss: 0.6688, Active: 2/2
  FUS/EEA1 - Loss: 0.6401, Acc: 0.6783 
  HSP70/SOD1 - Loss: 0.6974, Acc: 0.5383 
Cell Epoch 14/50, Overall Loss: 0.5887, Active: 2/2
  FUS/EEA1 - Loss: 0.5056, Acc: 0.7817 
  HSP70/SOD1 - Loss: 0.6719, Acc: 0.5867 
Cell Epoch 15/50, Overall Loss: 0.6527, Active: 2/2
  FUS/EEA1 - Loss: 0.6039, Acc: 0.6917 
  HSP70/SOD1 - Loss: 0.7015, Acc: 0.5350 
Cell Epoch 16/50, Overall Loss: 0.6447, Active: 2/2
  FUS/EEA1 - Loss: 0.5877, Acc: 0.6883 
  HSP70/SOD1 - Loss: 0.7016, Acc: 0.4967 
Cell Epoch 17/50, Overall Loss: 0.6190, Active: 2/2
  FUS/EEA1 - Loss: 0.5598, Acc: 0.7217 
  HSP70/SOD1 - Loss: 0.6783, Acc: 0.5767 
Cell Epoch 18/50, Overall Loss: 0.6303, Active: 2/2
  FUS/EEA1 - Loss: 0.6093, Acc: 0.6700 
  HSP70/SOD1 - Loss: 0.6513, Acc: 0.5917 
Cell Epoch 19/50, Overall Loss: 0.6283, Active: 2/2
  FUS/EEA1 - Loss: 0.5757, Acc: 0.6933 
  HSP70/SOD1 - Loss: 0.6809, Acc: 0.5883 
Cell Epoch 20/50, Overall Loss: 0.6302, Active: 2/2
  FUS/EEA1 - Loss: 0.5950, Acc: 0.6817 
  HSP70/SOD1 - Loss: 0.6655, Acc: 0.5933 
Cell Epoch 21/50, Overall Loss: 0.5899, Active: 2/2
  FUS/EEA1 - Loss: 0.5104, Acc: 0.7600 
  HSP70/SOD1 - Loss: 0.6693, Acc: 0.5717 
Cell Epoch 22/50, Overall Loss: 0.6113, Active: 2/2
  FUS/EEA1 - Loss: 0.5440, Acc: 0.7350 
  HSP70/SOD1 - Loss: 0.6787, Acc: 0.5583 
Cell Epoch 23/50, Overall Loss: 0.6161, Active: 2/2
  FUS/EEA1 - Loss: 0.5439, Acc: 0.7350 
  HSP70/SOD1 - Loss: 0.6884, Acc: 0.5483 
  Freezing FUS/EEA1 encoder at epoch 24
Cell Epoch 24/50, Overall Loss: 0.6115, Active: 1/2
  FUS/EEA1 - Loss: 0.5494, Acc: 0.7167 [FROZEN]
  HSP70/SOD1 - Loss: 0.6736, Acc: 0.5783 
Cell Epoch 25/50, Overall Loss: 0.6587, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6587, Acc: 0.6250 
Cell Epoch 26/50, Overall Loss: 0.7699, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7699, Acc: 0.5167 
Cell Epoch 27/50, Overall Loss: 0.7180, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7180, Acc: 0.5233 
  Freezing HSP70/SOD1 encoder at epoch 28
Cell Epoch 28/50, Overall Loss: 0.7712, Active: 0/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.7712, Acc: 0.4467 [FROZEN]
All antibodies frozen - stopping cell training at epoch 28
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.7191
Line Epoch 2/50, Loss: 0.5913
Line Epoch 3/50, Loss: 0.7532
Line Epoch 4/50, Loss: 0.3099
Line Epoch 5/50, Loss: 0.7655
Line Epoch 6/50, Loss: 0.4883
Line Epoch 7/50, Loss: 0.3192
Line Epoch 8/50, Loss: 0.3940
Line Epoch 9/50, Loss: 0.3877
Line Epoch 10/50, Loss: 0.5662
Line Epoch 11/50, Loss: 0.1376
Line Epoch 12/50, Loss: 0.2380
Line Epoch 13/50, Loss: 0.1511
Line Epoch 14/50, Loss: 0.0697
Line Epoch 15/50, Loss: 0.0811
Line Epoch 16/50, Loss: 0.0721
Line Epoch 17/50, Loss: 0.1325
Line Epoch 18/50, Loss: 0.2226
Line Epoch 19/50, Loss: 0.0209
Line Epoch 20/50, Loss: 0.3353
Line Epoch 21/50, Loss: 0.3588
Line Epoch 22/50, Loss: 0.1000
Line Epoch 23/50, Loss: 0.5706
Line Epoch 24/50, Loss: 0.1353
Line Epoch 25/50, Loss: 0.1661
Line Epoch 26/50, Loss: 0.1793
Line Epoch 27/50, Loss: 0.0793
Line Epoch 28/50, Loss: 0.2126
Line Epoch 29/50, Loss: 0.5089
Early stopping line training at epoch 29
Training completed!
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7432, Active: 2/2
  FUS/EEA1 - Loss: 0.7259, Acc: 0.5578 
  HSP70/SOD1 - Loss: 0.7606, Acc: 0.4967 
Cell Epoch 2/50, Overall Loss: 0.6980, Active: 2/2
  FUS/EEA1 - Loss: 0.6523, Acc: 0.6133 
  HSP70/SOD1 - Loss: 0.7436, Acc: 0.5233 
Cell Epoch 3/50, Overall Loss: 0.6387, Active: 2/2
  FUS/EEA1 - Loss: 0.5952, Acc: 0.6778 
  HSP70/SOD1 - Loss: 0.6821, Acc: 0.6056 
Cell Epoch 4/50, Overall Loss: 0.6629, Active: 2/2
  FUS/EEA1 - Loss: 0.6400, Acc: 0.6567 
  HSP70/SOD1 - Loss: 0.6858, Acc: 0.6078 
Cell Epoch 5/50, Overall Loss: 0.6067, Active: 2/2
  FUS/EEA1 - Loss: 0.5597, Acc: 0.7067 
  HSP70/SOD1 - Loss: 0.6537, Acc: 0.6311 
Cell Epoch 6/50, Overall Loss: 0.5946, Active: 2/2
  FUS/EEA1 - Loss: 0.5491, Acc: 0.7111 
  HSP70/SOD1 - Loss: 0.6400, Acc: 0.6233 
Cell Epoch 7/50, Overall Loss: 0.6768, Active: 2/2
  FUS/EEA1 - Loss: 0.6787, Acc: 0.6044 
  HSP70/SOD1 - Loss: 0.6750, Acc: 0.5833 
Cell Epoch 8/50, Overall Loss: 0.5905, Active: 2/2
  FUS/EEA1 - Loss: 0.5297, Acc: 0.7389 
  HSP70/SOD1 - Loss: 0.6513, Acc: 0.6122 
Cell Epoch 9/50, Overall Loss: 0.6171, Active: 2/2
  FUS/EEA1 - Loss: 0.5872, Acc: 0.6867 
  HSP70/SOD1 - Loss: 0.6470, Acc: 0.6156 /awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(

Cell Epoch 10/50, Overall Loss: 0.6018, Active: 2/2
  FUS/EEA1 - Loss: 0.5779, Acc: 0.6744 
  HSP70/SOD1 - Loss: 0.6258, Acc: 0.6256 
Cell Epoch 11/50, Overall Loss: 0.6289, Active: 2/2
  FUS/EEA1 - Loss: 0.6169, Acc: 0.7067 
  HSP70/SOD1 - Loss: 0.6409, Acc: 0.6267 
Cell Epoch 12/50, Overall Loss: 0.6233, Active: 2/2
  FUS/EEA1 - Loss: 0.6051, Acc: 0.6689 
  HSP70/SOD1 - Loss: 0.6414, Acc: 0.6233 
Cell Epoch 13/50, Overall Loss: 0.5928, Active: 2/2
  FUS/EEA1 - Loss: 0.5515, Acc: 0.7311 
  HSP70/SOD1 - Loss: 0.6341, Acc: 0.6411 
Cell Epoch 14/50, Overall Loss: 0.5768, Active: 2/2
  FUS/EEA1 - Loss: 0.5116, Acc: 0.7344 
  HSP70/SOD1 - Loss: 0.6419, Acc: 0.6233 
Cell Epoch 15/50, Overall Loss: 0.5997, Active: 2/2
  FUS/EEA1 - Loss: 0.5403, Acc: 0.7000 
  HSP70/SOD1 - Loss: 0.6590, Acc: 0.6211 
Cell Epoch 16/50, Overall Loss: 0.6087, Active: 2/2
  FUS/EEA1 - Loss: 0.5699, Acc: 0.7044 
  HSP70/SOD1 - Loss: 0.6476, Acc: 0.6300 
Cell Epoch 17/50, Overall Loss: 0.5948, Active: 2/2
  FUS/EEA1 - Loss: 0.5411, Acc: 0.7456 
  HSP70/SOD1 - Loss: 0.6486, Acc: 0.6178 
Cell Epoch 18/50, Overall Loss: 0.5666, Active: 2/2
  FUS/EEA1 - Loss: 0.5201, Acc: 0.7489 
  HSP70/SOD1 - Loss: 0.6131, Acc: 0.6667 
Cell Epoch 19/50, Overall Loss: 0.5787, Active: 2/2
  FUS/EEA1 - Loss: 0.5299, Acc: 0.7244 
  HSP70/SOD1 - Loss: 0.6274, Acc: 0.6478 
Cell Epoch 20/50, Overall Loss: 0.5753, Active: 2/2
  FUS/EEA1 - Loss: 0.5407, Acc: 0.7078 
  HSP70/SOD1 - Loss: 0.6099, Acc: 0.6656 
Cell Epoch 21/50, Overall Loss: 0.6023, Active: 2/2
  FUS/EEA1 - Loss: 0.5362, Acc: 0.7144 
  HSP70/SOD1 - Loss: 0.6685, Acc: 0.6167 
Cell Epoch 22/50, Overall Loss: 0.5816, Active: 2/2
  FUS/EEA1 - Loss: 0.5429, Acc: 0.7111 
  HSP70/SOD1 - Loss: 0.6202, Acc: 0.6456 
Cell Epoch 23/50, Overall Loss: 0.6200, Active: 2/2
  FUS/EEA1 - Loss: 0.5929, Acc: 0.6678 
  HSP70/SOD1 - Loss: 0.6471, Acc: 0.6144 
  Freezing FUS/EEA1 encoder at epoch 24
Cell Epoch 24/50, Overall Loss: 0.6749, Active: 1/2
  FUS/EEA1 - Loss: 0.6970, Acc: 0.6000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6529, Acc: 0.6167 
Cell Epoch 25/50, Overall Loss: 0.6097, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6097, Acc: 0.6589 
Cell Epoch 26/50, Overall Loss: 0.6590, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6590, Acc: 0.6289 
Cell Epoch 27/50, Overall Loss: 0.6032, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6032, Acc: 0.6589 
Cell Epoch 28/50, Overall Loss: 0.6986, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6986, Acc: 0.5633 
Cell Epoch 29/50, Overall Loss: 0.6529, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6529, Acc: 0.6167 
Cell Epoch 30/50, Overall Loss: 0.6585, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6585, Acc: 0.6256 
Cell Epoch 31/50, Overall Loss: 0.6646, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6646, Acc: 0.5956 
Cell Epoch 32/50, Overall Loss: 0.6148, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6148, Acc: 0.6389 
Cell Epoch 33/50, Overall Loss: 0.6630, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6630, Acc: 0.5856 
Cell Epoch 34/50, Overall Loss: 0.6236, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6236, Acc: 0.6289 
Cell Epoch 35/50, Overall Loss: 0.6073, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6073, Acc: 0.6611 
Cell Epoch 36/50, Overall Loss: 0.6369, Active: 1/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6369, Acc: 0.6267 
  Freezing HSP70/SOD1 encoder at epoch 37
Cell Epoch 37/50, Overall Loss: 0.6767, Active: 0/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6767, Acc: 0.5856 [FROZEN]
All antibodies frozen - stopping cell training at epoch 37
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.6372
Line Epoch 2/50, Loss: 0.5242
Line Epoch 3/50, Loss: 0.7083
Line Epoch 4/50, Loss: 0.6881
Line Epoch 5/50, Loss: 0.5739
Line Epoch 6/50, Loss: 1.2807
Line Epoch 7/50, Loss: 0.5844
Line Epoch 8/50, Loss: 0.3639
Line Epoch 9/50, Loss: 0.5141
Line Epoch 10/50, Loss: 0.3410
Line Epoch 11/50, Loss: 0.2848
Line Epoch 12/50, Loss: 0.5530
Line Epoch 13/50, Loss: 0.3964
Line Epoch 14/50, Loss: 0.1454
Line Epoch 15/50, Loss: 0.0694
Line Epoch 16/50, Loss: 0.2622
Line Epoch 17/50, Loss: 0.5418
Line Epoch 18/50, Loss: 0.4384
Line Epoch 19/50, Loss: 0.4439
Line Epoch 20/50, Loss: 0.2608
Line Epoch 21/50, Loss: 0.7073
Line Epoch 22/50, Loss: 0.6501
Line Epoch 23/50, Loss: 0.2500
Line Epoch 24/50, Loss: 0.1339
Line Epoch 25/50, Loss: 0.5064
Early stopping line training at epoch 25
Training completed!
Running replicate 6/50
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7805, Active: 2/2
  FUS/EEA1 - Loss: 0.7682, Acc: 0.4817 
  HSP70/SOD1 - Loss: 0.7928, Acc: 0.4717 
Cell Epoch 2/50, Overall Loss: 0.7173, Active: 2/2
  FUS/EEA1 - Loss: 0.6596, Acc: 0.6150 
  HSP70/SOD1 - Loss: 0.7751, Acc: 0.5067 
Cell Epoch 3/50, Overall Loss: 0.6791, Active: 2/2
  FUS/EEA1 - Loss: 0.6633, Acc: 0.6383 
  HSP70/SOD1 - Loss: 0.6949, Acc: 0.5717 
Cell Epoch 4/50, Overall Loss: 0.7103, Active: 2/2
  FUS/EEA1 - Loss: 0.6590, Acc: 0.6267 
  HSP70/SOD1 - Loss: 0.7615, Acc: 0.5333 
Cell Epoch 5/50, Overall Loss: 0.7403, Active: 2/2
  FUS/EEA1 - Loss: 0.6938, Acc: 0.6333 
  HSP70/SOD1 - Loss: 0.7867, Acc: 0.5000 
Cell Epoch 6/50, Overall Loss: 0.7072, Active: 2/2
  FUS/EEA1 - Loss: 0.7044, Acc: 0.6117 
  HSP70/SOD1 - Loss: 0.7101, Acc: 0.5600 
Cell Epoch 7/50, Overall Loss: 0.6872, Active: 2/2
  FUS/EEA1 - Loss: 0.6492, Acc: 0.6550 
  HSP70/SOD1 - Loss: 0.7253, Acc: 0.5250 
Cell Epoch 8/50, Overall Loss: 0.6754, Active: 2/2
  FUS/EEA1 - Loss: 0.6225, Acc: 0.6783 
  HSP70/SOD1 - Loss: 0.7282, Acc: 0.5017 
Cell Epoch 9/50, Overall Loss: 0.6328, Active: 2/2
  FUS/EEA1 - Loss: 0.5781, Acc: 0.7000 
  HSP70/SOD1 - Loss: 0.6875, Acc: 0.5800 
Cell Epoch 10/50, Overall Loss: 0.6288, Active: 2/2
  FUS/EEA1 - Loss: 0.5744, Acc: 0.7233 
  HSP70/SOD1 - Loss: 0.6831, Acc: 0.5583 
Cell Epoch 11/50, Overall Loss: 0.6507, Active: 2/2
  FUS/EEA1 - Loss: 0.6266, Acc: 0.6667 
  HSP70/SOD1 - Loss: 0.6748, Acc: 0.5917 
Cell Epoch 12/50, Overall Loss: 0.6558, Active: 2/2
  FUS/EEA1 - Loss: 0.6026, Acc: 0.6967 
  HSP70/SOD1 - Loss: 0.7091, Acc: 0.5600 
Cell Epoch 13/50, Overall Loss: 0.6705, Active: 2/2
  FUS/EEA1 - Loss: 0.6152, Acc: 0.6583 
  HSP70/SOD1 - Loss: 0.7258, Acc: 0.5333 
Cell Epoch 14/50, Overall Loss: 0.6524, Active: 2/2
  FUS/EEA1 - Loss: 0.5962, Acc: 0.6950 
  HSP70/SOD1 - Loss: 0.7086, Acc: 0.5317 
Cell Epoch 15/50, Overall Loss: 0.6625, Active: 2/2
  FUS/EEA1 - Loss: 0.6216, Acc: 0.6517 
  HSP70/SOD1 - Loss: 0.7033, Acc: 0.5367 
Cell Epoch 16/50, Overall Loss: 0.6724, Active: 2/2
  FUS/EEA1 - Loss: 0.6386, Acc: 0.6350 
  HSP70/SOD1 - Loss: 0.7062, Acc: 0.5417 
Cell Epoch 17/50, Overall Loss: 0.6251, Active: 2/2
  FUS/EEA1 - Loss: 0.5729, Acc: 0.6967 
  HSP70/SOD1 - Loss: 0.6772, Acc: 0.5650 
Cell Epoch 18/50, Overall Loss: 0.6233, Active: 2/2
  FUS/EEA1 - Loss: 0.5330, Acc: 0.7667 
  HSP70/SOD1 - Loss: 0.7135, Acc: 0.5133 
Cell Epoch 19/50, Overall Loss: 0.6344, Active: 2/2
  FUS/EEA1 - Loss: 0.5586, Acc: 0.7150 
  HSP70/SOD1 - Loss: 0.7103, Acc: 0.5300 
Cell Epoch 20/50, Overall Loss: 0.6168, Active: 2/2
  FUS/EEA1 - Loss: 0.5601, Acc: 0.7417 
  HSP70/SOD1 - Loss: 0.6736, Acc: 0.5567 
Cell Epoch 21/50, Overall Loss: 0.6426, Active: 2/2
  FUS/EEA1 - Loss: 0.6101, Acc: 0.7033 
  HSP70/SOD1 - Loss: 0.6750, Acc: 0.5717 
Cell Epoch 22/50, Overall Loss: 0.6371, Active: 2/2
  FUS/EEA1 - Loss: 0.6002, Acc: 0.6850 
  HSP70/SOD1 - Loss: 0.6740, Acc: 0.5583 
Cell Epoch 23/50, Overall Loss: 0.6535, Active: 2/2
  FUS/EEA1 - Loss: 0.6194, Acc: 0.6733 
  HSP70/SOD1 - Loss: 0.6876, Acc: 0.5500 
Cell Epoch 24/50, Overall Loss: 0.6000, Active: 2/2
  FUS/EEA1 - Loss: 0.5395, Acc: 0.7383 
  HSP70/SOD1 - Loss: 0.6605, Acc: 0.6033 
Cell Epoch 25/50, Overall Loss: 0.6386, Active: 2/2/awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
/awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(

  FUS/EEA1 - Loss: 0.5753, Acc: 0.6900 
  HSP70/SOD1 - Loss: 0.7019, Acc: 0.5317 
Cell Epoch 26/50, Overall Loss: 0.6021, Active: 2/2
  FUS/EEA1 - Loss: 0.5300, Acc: 0.7567 
  HSP70/SOD1 - Loss: 0.6742, Acc: 0.5717 
Cell Epoch 27/50, Overall Loss: 0.5802, Active: 2/2
  FUS/EEA1 - Loss: 0.4795, Acc: 0.7900 
  HSP70/SOD1 - Loss: 0.6808, Acc: 0.5650 
Cell Epoch 28/50, Overall Loss: 0.6768, Active: 2/2
  FUS/EEA1 - Loss: 0.6606, Acc: 0.6183 
  HSP70/SOD1 - Loss: 0.6930, Acc: 0.5133 
Cell Epoch 29/50, Overall Loss: 0.6384, Active: 2/2
  FUS/EEA1 - Loss: 0.5905, Acc: 0.7033 
  HSP70/SOD1 - Loss: 0.6863, Acc: 0.5700 
Cell Epoch 30/50, Overall Loss: 0.6461, Active: 2/2
  FUS/EEA1 - Loss: 0.6203, Acc: 0.6933 
  HSP70/SOD1 - Loss: 0.6718, Acc: 0.5750 
Cell Epoch 31/50, Overall Loss: 0.6310, Active: 2/2
  FUS/EEA1 - Loss: 0.5868, Acc: 0.6667 
  HSP70/SOD1 - Loss: 0.6751, Acc: 0.5633 
Cell Epoch 32/50, Overall Loss: 0.6522, Active: 2/2
  FUS/EEA1 - Loss: 0.5949, Acc: 0.6883 
  HSP70/SOD1 - Loss: 0.7095, Acc: 0.5100 
Cell Epoch 33/50, Overall Loss: 0.6090, Active: 2/2
  FUS/EEA1 - Loss: 0.5522, Acc: 0.7417 
  HSP70/SOD1 - Loss: 0.6658, Acc: 0.6000 
  Freezing HSP70/SOD1 encoder at epoch 34
Cell Epoch 34/50, Overall Loss: 0.6542, Active: 1/2
  FUS/EEA1 - Loss: 0.6142, Acc: 0.6800 
  HSP70/SOD1 - Loss: 0.6942, Acc: 0.5400 [FROZEN]
Cell Epoch 35/50, Overall Loss: 0.6403, Active: 1/2
  FUS/EEA1 - Loss: 0.6403, Acc: 0.6750 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
Cell Epoch 36/50, Overall Loss: 0.6385, Active: 1/2
  FUS/EEA1 - Loss: 0.6385, Acc: 0.6383 
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  Freezing FUS/EEA1 encoder at epoch 37
Cell Epoch 37/50, Overall Loss: 0.5741, Active: 0/2
  FUS/EEA1 - Loss: 0.5741, Acc: 0.6983 [FROZEN]
  HSP70/SOD1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
All antibodies frozen - stopping cell training at epoch 37
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.9962
Line Epoch 2/50, Loss: 0.7978
Line Epoch 3/50, Loss: 0.4914
Line Epoch 4/50, Loss: 0.6957
Line Epoch 5/50, Loss: 0.3474
Line Epoch 6/50, Loss: 0.1297
Line Epoch 7/50, Loss: 0.1891
Line Epoch 8/50, Loss: 0.2750
Line Epoch 9/50, Loss: 0.1347
Line Epoch 10/50, Loss: 0.4695
Line Epoch 11/50, Loss: 0.8384
Line Epoch 12/50, Loss: 0.1309
Line Epoch 13/50, Loss: 0.2055
Line Epoch 14/50, Loss: 1.1098
Line Epoch 15/50, Loss: 0.0894
Line Epoch 16/50, Loss: 0.1490
Line Epoch 17/50, Loss: 0.7112
Line Epoch 18/50, Loss: 0.0866
Line Epoch 19/50, Loss: 0.2353
Line Epoch 20/50, Loss: 0.0954
Line Epoch 21/50, Loss: 0.1801
Line Epoch 22/50, Loss: 0.4028
Line Epoch 23/50, Loss: 0.2354
Line Epoch 24/50, Loss: 0.0596
Line Epoch 25/50, Loss: 0.0924
Line Epoch 26/50, Loss: 0.2202
Line Epoch 27/50, Loss: 0.6373
Line Epoch 28/50, Loss: 0.2774
Line Epoch 29/50, Loss: 0.1387
Line Epoch 30/50, Loss: 0.1596
Line Epoch 31/50, Loss: 0.1431
Line Epoch 32/50, Loss: 0.3699
Line Epoch 33/50, Loss: 0.2062
Line Epoch 34/50, Loss: 0.0932
Early stopping line training at epoch 34
Training completed!
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7629, Active: 2/2
  FUS/EEA1 - Loss: 0.7759, Acc: 0.5311 
  HSP70/SOD1 - Loss: 0.7498, Acc: 0.5033 
Cell Epoch 2/50, Overall Loss: 0.6933, Active: 2/2
  FUS/EEA1 - Loss: 0.6944, Acc: 0.5911 
  HSP70/SOD1 - Loss: 0.6921, Acc: 0.5867 
Cell Epoch 3/50, Overall Loss: 0.6617, Active: 2/2
  FUS/EEA1 - Loss: 0.6483, Acc: 0.6356 
  HSP70/SOD1 - Loss: 0.6751, Acc: 0.5833 
Cell Epoch 4/50, Overall Loss: 0.6788, Active: 2/2
  FUS/EEA1 - Loss: 0.6729, Acc: 0.6178 
  HSP70/SOD1 - Loss: 0.6847, Acc: 0.5967 
Cell Epoch 5/50, Overall Loss: 0.6249, Active: 2/2
  FUS/EEA1 - Loss: 0.5794, Acc: 0.7044 
  HSP70/SOD1 - Loss: 0.6703, Acc: 0.6144 
Cell Epoch 6/50, Overall Loss: 0.6444, Active: 2/2
  FUS/EEA1 - Loss: 0.6265, Acc: 0.6778 
  HSP70/SOD1 - Loss: 0.6622, Acc: 0.6111 
Cell Epoch 7/50, Overall Loss: 0.6402, Active: 2/2
  FUS/EEA1 - Loss: 0.6242, Acc: 0.6556 
  HSP70/SOD1 - Loss: 0.6562, Acc: 0.6067 
Cell Epoch 8/50, Overall Loss: 0.6130, Active: 2/2
  FUS/EEA1 - Loss: 0.5813, Acc: 0.6867 
  HSP70/SOD1 - Loss: 0.6446, Acc: 0.6222 
Cell Epoch 9/50, Overall Loss: 0.5774, Active: 2/2
  FUS/EEA1 - Loss: 0.5185, Acc: 0.7333 
  HSP70/SOD1 - Loss: 0.6363, Acc: 0.6278 
Cell Epoch 10/50, Overall Loss: 0.6104, Active: 2/2
  FUS/EEA1 - Loss: 0.6013, Acc: 0.6767 
  HSP70/SOD1 - Loss: 0.6196, Acc: 0.6322 
Cell Epoch 11/50, Overall Loss: 0.6650, Active: 2/2
  FUS/EEA1 - Loss: 0.6200, Acc: 0.6833 
  HSP70/SOD1 - Loss: 0.7100, Acc: 0.5533 
Cell Epoch 12/50, Overall Loss: 0.6475, Active: 2/2
  FUS/EEA1 - Loss: 0.6191, Acc: 0.6878 
  HSP70/SOD1 - Loss: 0.6760, Acc: 0.5644 
Cell Epoch 13/50, Overall Loss: 0.5928, Active: 2/2
  FUS/EEA1 - Loss: 0.5399, Acc: 0.7122 
  HSP70/SOD1 - Loss: 0.6457, Acc: 0.6178 
Cell Epoch 14/50, Overall Loss: 0.6078, Active: 2/2
  FUS/EEA1 - Loss: 0.5928, Acc: 0.6833 
  HSP70/SOD1 - Loss: 0.6227, Acc: 0.6422 
Cell Epoch 15/50, Overall Loss: 0.5985, Active: 2/2
  FUS/EEA1 - Loss: 0.5576, Acc: 0.7100 
  HSP70/SOD1 - Loss: 0.6393, Acc: 0.6189 
Cell Epoch 16/50, Overall Loss: 0.5861, Active: 2/2
  FUS/EEA1 - Loss: 0.5494, Acc: 0.7078 
  HSP70/SOD1 - Loss: 0.6228, Acc: 0.6578 
Cell Epoch 17/50, Overall Loss: 0.6023, Active: 2/2
  FUS/EEA1 - Loss: 0.5497, Acc: 0.7067 
  HSP70/SOD1 - Loss: 0.6548, Acc: 0.6278 
Cell Epoch 18/50, Overall Loss: 0.6023, Active: 2/2
  FUS/EEA1 - Loss: 0.5539, Acc: 0.7167 
  HSP70/SOD1 - Loss: 0.6507, Acc: 0.6111 
  Freezing FUS/EEA1 encoder at epoch 19
Cell Epoch 19/50, Overall Loss: 0.6179, Active: 1/2
  FUS/EEA1 - Loss: 0.5775, Acc: 0.6922 [FROZEN]
  HSP70/SOD1 - Loss: 0.6584, Acc: 0.6056 
  Freezing HSP70/SOD1 encoder at epoch 20
Cell Epoch 20/50, Overall Loss: 0.6836, Active: 0/2
  FUS/EEA1 - Loss: 0.0000, Acc: 0.0000 [FROZEN]
  HSP70/SOD1 - Loss: 0.6836, Acc: 0.6044 [FROZEN]
All antibodies frozen - stopping cell training at epoch 20
Starting line-level training...
Unfreezing all antibody encoders for line training...
Line Epoch 1/50, Loss: 0.9697
Line Epoch 2/50, Loss: 0.5036
Line Epoch 3/50, Loss: 1.0847
Line Epoch 4/50, Loss: 0.5434
Line Epoch 5/50, Loss: 0.4055
Line Epoch 6/50, Loss: 0.5503
Line Epoch 7/50, Loss: 0.3010
Line Epoch 8/50, Loss: 0.2780
Line Epoch 9/50, Loss: 0.1232
Line Epoch 10/50, Loss: 0.3197
Line Epoch 11/50, Loss: 0.2059
Line Epoch 12/50, Loss: 0.2212
Line Epoch 13/50, Loss: 0.1615
Line Epoch 14/50, Loss: 0.3551
Line Epoch 15/50, Loss: 0.3170
Line Epoch 16/50, Loss: 0.2207
Line Epoch 17/50, Loss: 0.2932
Line Epoch 18/50, Loss: 0.0410
Line Epoch 19/50, Loss: 0.0891
Line Epoch 20/50, Loss: 0.3544
Line Epoch 21/50, Loss: 0.3803
Line Epoch 22/50, Loss: 1.0166
Line Epoch 23/50, Loss: 0.2259
Line Epoch 24/50, Loss: 0.0944
Line Epoch 25/50, Loss: 0.2875
Line Epoch 26/50, Loss: 0.1574
Line Epoch 27/50, Loss: 0.3155
Line Epoch 28/50, Loss: 0.2685
Early stopping line training at epoch 28
Training completed!
Running replicate 7/50
Starting cell-level training...
Cell Epoch 1/50, Overall Loss: 0.7996, Active: 2/2
  FUS/EEA1 - Loss: 0.8076, Acc: 0.4400 
  HSP70/SOD1 - Loss: 0.7916, Acc: 0.4600 
Cell Epoch 2/50, Overall Loss: 0.7186, Active: 2/2
  FUS/EEA1 - Loss: 0.7056, Acc: 0.5517 
  HSP70/SOD1 - Loss: 0.7317, Acc: 0.4900 
Cell Epoch 3/50, Overall Loss: 0.6556, Active: 2/2
  FUS/EEA1 - Loss: 0.6278, Acc: 0.6483 
  HSP70/SOD1 - Loss: 0.6834, Acc: 0.5667 
Cell Epoch 4/50, Overall Loss: 0.6590, Active: 2/2
  FUS/EEA1 - Loss: 0.5910, Acc: 0.6850 
  HSP70/SOD1 - Loss: 0.7270, Acc: 0.5350 
Cell Epoch 5/50, Overall Loss: 0.6248, Active: 2/2
  FUS/EEA1 - Loss: 0.5606, Acc: 0.7317 
  HSP70/SOD1 - Loss: 0.6890, Acc: 0.5683 
Cell Epoch 6/50, Overall Loss: 0.6518, Active: 2/2
  FUS/EEA1 - Loss: 0.6105, Acc: 0.6867 
  HSP70/SOD1 - Loss: 0.6931, Acc: 0.5917 
Cell Epoch 7/50, Overall Loss: 0.7463, Active: 2/2
  FUS/EEA1 - Loss: 0.7443, Acc: 0.6017 
  HSP70/SOD1 - Loss: 0.7483, Acc: 0.4983 
Cell Epoch 8/50, Overall Loss: 0.6892, Active: 2/2
  FUS/EEA1 - Loss: 0.6432, Acc: 0.6600 
  HSP70/SOD1 - Loss: 0.7353, Acc: 0.5183 
Cell Epoch 9/50, Overall Loss: 0.6300, Active: 2/2
  FUS/EEA1 - Loss: 0.5651, Acc: 0.7233 
  HSP70/SOD1 - Loss: 0.6949, Acc: 0.5583 
Cell Epoch 10/50, Overall Loss: 0.6815, Active: 2/2/awlab/projects/2024_ALS/software/miniforge3/envs/maps/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
